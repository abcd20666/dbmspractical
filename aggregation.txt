MongoDB Practical â€“ Aggregation & Indexing
// âœ… 1) Create Student Collection (Aggregation Example)
db.createCollection("student");

// âœ… 2) Insert Documents
db.student.insert({Rollno:1, name:'Navin', subject:'DMSA', marks:78});
db.student.insert({Rollno:2, name:'anusha', subject:'OSD',  marks:75});
db.student.insert({Rollno:3, name:'ravi',   subject:'TOC',  marks:69});
db.student.insert({Rollno:4, name:'veena',  subject:'TOC',  marks:70});

// âœ… 3) Display Records
db.student.find();
db.student.find().pretty();


// âœ… 4) Aggregation Operations

// ðŸ”¹ MIN marks per subject
db.student.aggregate([
    { $group: { _id: "$subject", marks: { $min: "$marks" } } }
]);

// ðŸ”¹ MAX marks per subject
db.student.aggregate([
    { $group: { _id: "$subject", marks: { $max: "$marks" } } }
]);

// ðŸ”¹ SUM marks per subject
db.student.aggregate([
    { $group: { _id: "$subject", marks: { $sum: "$marks" } } }
]);

// ðŸ”¹ AVG marks per subject
db.student.aggregate([
    { $group: { _id: "$subject", marks: { $avg: "$marks" } } }
]);

// ðŸ”¹ FIRST marks in each subject
db.student.aggregate([
    { $group: { _id: "$subject", marks: { $first: "$marks" } } }
]);

// ðŸ”¹ LAST marks in each subject
db.student.aggregate([
    { $group: { _id: "$subject", marks: { $last: "$marks" } } }
]);



// -------------------------------------------------------
// âœ… 2) Create Employee Collection (Indexing Example)
// -------------------------------------------------------

db.createCollection("employee");

// âœ… Insert Data
db.employee.insertMany([
  {emp_id: 101, name: "Amit",  department: "HR",    salary: 40000},
  {emp_id: 102, name: "Riya",  department: "IT",    salary: 70000},
  {emp_id: 103, name: "Raj",   department: "Sales", salary: 55000},
  {emp_id: 104, name: "Karan", department: "IT",    salary: 80000},
  {emp_id: 105, name: "Neha",  department: "HR",    salary: 60000}
]);

// âœ… Display Records
db.employee.find().pretty();


// âœ… Create Index on department
db.employee.createIndex({ department: 1 });

// âœ… Check index use
db.employee.find({ department: "IT" }).explain("executionStats");


// âœ… Drop index
db.employee.dropIndex({ department: 1 });

